#lang racket/base

(provide zhupin-pst)

(module+ internal
  (provide zhupin-table))

(require (only-in racket/stream
                  for/stream)
         (only-in racket/string
                  string-append*)

         pin1yin1/pst)

(define zhupin-table
  '(; b-
    ("ㄅㄚ"    . ["b"   "a"   ""    ])
    ("ㄅㄛ"    . ["b"   "o"   ""    ])
    ("ㄅㄞ"    . ["b"   "a"   "i"   ])
    ("ㄅㄟ"    . ["b"   "e"   "i"   ])
    ("ㄅㄠ"    . ["b"   "a"   "o"   ])
    ("ㄅㄢ"    . ["b"   "a"   "n"   ])
    ("ㄅㄣ"    . ["b"   "e"   "n"   ])
    ("ㄅㄤ"    . ["b"   "a"   "ng"  ])
    ("ㄅㄥ"    . ["b"   "e"   "ng"  ])
    ("ㄅㄧ"    . ["b"   "i"   ""    ])
    ("ㄅㄧㄝ"   . ["bi"  "e"   ""    ])
    ("ㄅㄧㄠ"   . ["bi"  "a"   "o"   ])
    ("ㄅㄧㄢ"   . ["bi"  "a"   "n"   ])
    ("ㄅㄧㄣ"   . ["b"   "i"   "n"   ])
    ("ㄅㄧㄤ"   . ["bi"  "a"   "ng"  ])
    ("ㄅㄧㄥ"   . ["b"   "i"   "ng"  ])
    ("ㄅㄨ"    . ["b"   "u"   ""    ])

    ; p-
    ("ㄆㄚ"    . ["p"   "a"   ""    ])
    ("ㄆㄛ"    . ["p"   "o"   ""    ])
    ("ㄆㄞ"    . ["p"   "a"   "i"   ])
    ("ㄆㄟ"    . ["p"   "e"   "i"   ])
    ("ㄆㄠ"    . ["p"   "a"   "o"   ])
    ("ㄆㄡ"    . ["p"   "o"   "u"   ])
    ("ㄆㄢ"    . ["p"   "a"   "n"   ])
    ("ㄆㄣ"    . ["p"   "e"   "n"   ])
    ("ㄆㄤ"    . ["p"   "a"   "ng"  ])
    ("ㄆㄥ"    . ["p"   "e"   "ng"  ])
    ("ㄆㄧ"    . ["p"   "i"   ""    ])
    ("ㄆㄧㄝ"   . ["pi"  "e"   ""    ])
    ("ㄆㄧㄠ"   . ["pi"  "a"   "o"   ])
    ("ㄆㄧㄢ"   . ["pi"  "a"   "n"   ])
    ("ㄆㄧㄣ"   . ["p"   "i"   "n"   ])
    ("ㄆㄧㄥ"   . ["p"   "i"   "ng"  ])
    ("ㄆㄨ"    . ["p"   "u"   ""    ])

    ; m-
    ("ㄇ"     . [""    "m"   ""    ])
    ("ㄇㄚ"    . ["m"   "a"   ""    ])
    ("ㄇㄛ"    . ["m"   "o"   ""    ])
    ("ㄇㄜ"    . ["m"   "e"   ""    ])
    ("ㄇㄞ"    . ["m"   "a"   "i"   ])
    ("ㄇㄟ"    . ["m"   "e"   "i"   ])
    ("ㄇㄠ"    . ["m"   "a"   "o"   ])
    ("ㄇㄡ"    . ["m"   "o"   "u"   ])
    ("ㄇㄢ"    . ["m"   "a"   "n"   ])
    ("ㄇㄣ"    . ["m"   "e"   "n"   ])
    ("ㄇㄤ"    . ["m"   "a"   "ng"  ])
    ("ㄇㄥ"    . ["m"   "e"   "ng"  ])
    ("ㄇㄧ"    . ["m"   "i"   ""    ])
    ("ㄇㄧㄝ"   . ["mi"  "e"   ""    ])
    ("ㄇㄧㄠ"   . ["mi"  "a"   "o"   ])
    ("ㄇㄧㄡ"   . ["mi"  "u"   ""    ])
    ("ㄇㄧㄢ"   . ["mi"  "a"   "n"   ])
    ("ㄇㄧㄣ"   . ["m"   "i"   "n"   ])
    ("ㄇㄧㄥ"   . ["m"   "i"   "ng"  ])
    ("ㄇㄨ"    . ["m"   "u"   ""    ])

    ; f-
    ("ㄈㄚ"    . ["f"   "a"   ""    ])
    ("ㄈㄛ"    . ["f"   "o"   ""    ])
    ("ㄈㄟ"    . ["f"   "e"   "i"   ])
    ("ㄈㄡ"    . ["f"   "o"   "u"   ])
    ("ㄈㄢ"    . ["f"   "a"   "n"   ])
    ("ㄈㄣ"    . ["f"   "e"   "n"   ])
    ("ㄈㄤ"    . ["f"   "a"   "ng"  ])
    ("ㄈㄥ"    . ["f"   "e"   "ng"  ])
    ("ㄈㄨ"    . ["f"   "u"   ""    ])

    ; d-
    ("ㄉㄚ"    . ["d"   "a"   ""    ])
    ("ㄉㄜ"    . ["d"   "e"   ""    ])
    ("ㄉㄞ"    . ["d"   "a"   "i"   ])
    ("ㄉㄟ"    . ["d"   "e"   "i"   ])
    ("ㄉㄠ"    . ["d"   "a"   "o"   ])
    ("ㄉㄡ"    . ["d"   "o"   "u"   ])
    ("ㄉㄢ"    . ["d"   "a"   "n"   ])
    ("ㄉㄣ"    . ["d"   "e"   "n"   ])
    ("ㄉㄤ"    . ["d"   "a"   "ng"  ])
    ("ㄉㄥ"    . ["d"   "e"   "ng"  ])
    ("ㄉㄧ"    . ["d"   "i"   ""    ])
    ("ㄉㄧㄝ"   . ["di"  "e"   ""    ])
    ("ㄉㄧㄠ"   . ["di"  "a"   "o"   ])
    ("ㄉㄧㄡ"   . ["di"  "u"   ""    ])
    ("ㄉㄧㄢ"   . ["di"  "a"   "n"   ])
    ("ㄉㄧㄥ"   . ["d"   "i"   "ng"  ])
    ("ㄉㄨ"    . ["d"   "u"   ""    ])
    ("ㄉㄨㄛ"   . ["du"  "o"   ""    ])
    ("ㄉㄨㄟ"   . ["du"  "i"   ""    ])
    ("ㄉㄨㄢ"   . ["du"  "a"   "n"   ])
    ("ㄉㄨㄣ"   . ["d"   "u"   "n"   ])
    ("ㄉㄨㄤ"   . ["du"  "a"   "ng"  ])
    ("ㄉㄨㄥ"   . ["d"   "o"   "ng"  ])

    ; t-
    ("ㄊㄚ"    . ["t"   "a"   ""    ])
    ("ㄊㄜ"    . ["t"   "e"   ""    ])
    ("ㄊㄞ"    . ["t"   "a"   "i"   ])
    ("ㄊㄠ"    . ["t"   "a"   "o"   ])
    ("ㄊㄡ"    . ["t"   "o"   "u"   ])
    ("ㄊㄢ"    . ["t"   "a"   "n"   ])
    ("ㄊㄤ"    . ["t"   "a"   "ng"  ])
    ("ㄊㄥ"    . ["t"   "e"   "ng"  ])
    ("ㄊㄧ"    . ["t"   "i"   ""    ])
    ("ㄊㄧㄝ"   . ["ti"  "e"   ""    ])
    ("ㄊㄧㄠ"   . ["ti"  "a"   "o"   ])
    ("ㄊㄧㄢ"   . ["ti"  "a"   "n"   ])
    ("ㄊㄧㄥ"   . ["t"   "i"   "ng"  ])
    ("ㄊㄨ"    . ["t"   "u"   ""    ])
    ("ㄊㄨㄛ"   . ["tu"  "o"   ""    ])
    ("ㄊㄨㄟ"   . ["tu"  "i"   ""    ])
    ("ㄊㄨㄢ"   . ["tu"  "a"   "n"   ])
    ("ㄊㄨㄣ"   . ["t"   "u"   "n"   ])
    ("ㄊㄨㄥ"   . ["t"   "o"   "ng"  ])

    ; n-
    ("ㄋ"     . [""    "n"   ""    ])
    ("ㄋㄚ"    . ["n"   "a"   ""    ])
    ("ㄋㄜ"    . ["n"   "e"   ""    ])
    ("ㄋㄞ"    . ["n"   "a"   "i"   ])
    ("ㄋㄟ"    . ["n"   "e"   "i"   ])
    ("ㄋㄠ"    . ["n"   "a"   "o"   ])
    ("ㄋㄡ"    . ["n"   "o"   "u"   ])
    ("ㄋㄢ"    . ["n"   "a"   "n"   ])
    ("ㄋㄣ"    . ["n"   "e"   "n"   ])
    ("ㄋㄤ"    . ["n"   "a"   "ng"  ])
    ("ㄋㄥ"    . ["n"   "e"   "ng"  ])
    ("ㄋㄧ"    . ["n"   "i"   ""    ])
    ("ㄋㄧㄝ"   . ["ni"  "e"   ""    ])
    ("ㄋㄧㄠ"   . ["ni"  "a"   "o"   ])
    ("ㄋㄧㄡ"   . ["ni"  "u"   ""    ])
    ("ㄋㄧㄢ"   . ["ni"  "a"   "n"   ])
    ("ㄋㄧㄣ"   . ["n"   "i"   "n"   ])
    ("ㄋㄧㄤ"   . ["ni"  "a"   "ng"  ])
    ("ㄋㄧㄥ"   . ["n"   "i"   "ng"  ])
    ("ㄋㄨ"    . ["n"   "u"   ""    ])
    ("ㄋㄨㄛ"   . ["nu"  "o"   ""    ])
    ("ㄋㄨㄢ"   . ["nu"  "a"   "n"   ])
    ("ㄋㄨㄥ"   . ["n"   "o"   "ng"  ])
    ("ㄋㄩ"    . ["n"   "ü"   ""    ])
    ("ㄋㄩㄝ"   . ["nü"  "e"   ""    ])

    ; l-
    ("ㄌㄚ"    . ["l"   "a"   ""    ])
    ("ㄌㄛ"    . ["l"   "o"   ""    ])
    ("ㄌㄜ"    . ["l"   "e"   ""    ])
    ("ㄌㄞ"    . ["l"   "a"   "i"   ])
    ("ㄌㄟ"    . ["l"   "e"   "i"   ])
    ("ㄌㄠ"    . ["l"   "a"   "o"   ])
    ("ㄌㄡ"    . ["l"   "o"   "u"   ])
    ("ㄌㄢ"    . ["l"   "a"   "n"   ])
    ("ㄌㄤ"    . ["l"   "a"   "ng"  ])
    ("ㄌㄥ"    . ["l"   "e"   "ng"  ])
    ("ㄌㄧ"    . ["l"   "i"   ""    ])
    ("ㄌㄧㄚ"   . ["li"  "a"   ""    ])
    ("ㄌㄧㄝ"   . ["li"  "e"   ""    ])
    ("ㄌㄧㄠ"   . ["li"  "a"   "o"   ])
    ("ㄌㄧㄡ"   . ["li"  "u"   ""    ])
    ("ㄌㄧㄢ"   . ["li"  "a"   "n"   ])
    ("ㄌㄧㄣ"   . ["l"   "i"   "n"   ])
    ("ㄌㄧㄤ"   . ["li"  "a"   "ng"  ])
    ("ㄌㄧㄥ"   . ["l"   "i"   "ng"  ])
    ("ㄌㄨ"    . ["l"   "u"   ""    ])
    ("ㄌㄨㄛ"   . ["lu"  "o"   ""    ])
    ("ㄌㄨㄢ"   . ["lu"  "a"   "n"   ])
    ("ㄌㄨㄣ"   . ["l"   "u"   "n"   ])
    ("ㄌㄨㄥ"   . ["l"   "o"   "ng"  ])
    ("ㄌㄩ"    . ["l"   "ü"   ""    ])
    ("ㄌㄩㄝ"   . ["lü"  "e"   ""    ])

    ; g-
    ("ㄍㄚ"    . ["g"   "a"   ""    ])
    ("ㄍㄜ"    . ["g"   "e"   ""    ])
    ("ㄍㄞ"    . ["g"   "a"   "i"   ])
    ("ㄍㄟ"    . ["g"   "e"   "i"   ])
    ("ㄍㄠ"    . ["g"   "a"   "o"   ])
    ("ㄍㄡ"    . ["g"   "o"   "u"   ])
    ("ㄍㄢ"    . ["g"   "a"   "n"   ])
    ("ㄍㄣ"    . ["g"   "e"   "n"   ])
    ("ㄍㄤ"    . ["g"   "a"   "ng"  ])
    ("ㄍㄥ"    . ["g"   "e"   "ng"  ])
    ("ㄍㄨ"    . ["g"   "u"   ""    ])
    ("ㄍㄨㄚ"   . ["gu"  "a"   ""    ])
    ("ㄍㄨㄛ"   . ["gu"  "o"   ""    ])
    ("ㄍㄨㄞ"   . ["gu"  "a"   "i"   ])
    ("ㄍㄨㄟ"   . ["gu"  "i"   ""    ])
    ("ㄍㄨㄢ"   . ["gu"  "a"   "n"   ])
    ("ㄍㄨㄣ"   . ["g"   "u"   "n"   ])
    ("ㄍㄨㄤ"   . ["gu"  "a"   "ng"  ])
    ("ㄍㄨㄥ"   . ["g"   "o"   "ng"  ])

    ; k-
    ("ㄎㄚ"    . ["k"   "a"   ""    ])
    ("ㄎㄜ"    . ["k"   "e"   ""    ])
    ("ㄎㄞ"    . ["k"   "a"   "i"   ])
    ("ㄎㄟ"    . ["k"   "e"   "i"   ])
    ("ㄎㄠ"    . ["k"   "a"   "o"   ])
    ("ㄎㄡ"    . ["k"   "o"   "u"   ])
    ("ㄎㄢ"    . ["k"   "a"   "n"   ])
    ("ㄎㄣ"    . ["k"   "e"   "n"   ])
    ("ㄎㄤ"    . ["k"   "a"   "ng"  ])
    ("ㄎㄥ"    . ["k"   "e"   "ng"  ])
    ("ㄎㄨ"    . ["k"   "u"   ""    ])
    ("ㄎㄨㄚ"   . ["ku"  "a"   ""    ])
    ("ㄎㄨㄛ"   . ["ku"  "o"   ""    ])
    ("ㄎㄨㄞ"   . ["ku"  "a"   "i"   ])
    ("ㄎㄨㄟ"   . ["ku"  "i"   ""    ])
    ("ㄎㄨㄢ"   . ["ku"  "a"   "n"   ])
    ("ㄎㄨㄣ"   . ["k"   "u"   "n"   ])
    ("ㄎㄨㄤ"   . ["ku"  "a"   "ng"  ])
    ("ㄎㄨㄥ"   . ["k"   "o"   "ng"  ])

    ; ng-
    ("ㄫ"     . [""    "n"   "g"   ])

    ; h-
    ("ㄏㄚ"    . ["h"   "a"   ""    ])
    ("ㄏㄜ"    . ["h"   "e"   ""    ])
    ("ㄏㄞ"    . ["h"   "a"   "i"   ])
    ("ㄏㄟ"    . ["h"   "e"   "i"   ])
    ("ㄏㄠ"    . ["h"   "a"   "o"   ])
    ("ㄏㄡ"    . ["h"   "o"   "u"   ])
    ("ㄏㄢ"    . ["h"   "a"   "n"   ])
    ("ㄏㄣ"    . ["h"   "e"   "n"   ])
    ("ㄏㄤ"    . ["h"   "a"   "ng"  ])
    ("ㄏㄥ"    . ["h"   "e"   "ng"  ])
    ("ㄏㄨ"    . ["h"   "u"   ""    ])
    ("ㄏㄨㄚ"   . ["hu"  "a"   ""    ])
    ("ㄏㄨㄛ"   . ["hu"  "o"   ""    ])
    ("ㄏㄨㄞ"   . ["hu"  "a"   "i"   ])
    ("ㄏㄨㄟ"   . ["hu"  "i"   ""    ])
    ("ㄏㄨㄢ"   . ["hu"  "a"   "n"   ])
    ("ㄏㄨㄣ"   . ["h"   "u"   "n"   ])
    ("ㄏㄨㄤ"   . ["hu"  "a"   "ng"  ])
    ("ㄏㄨㄥ"   . ["h"   "o"   "ng"  ])

    ; j-
    ("ㄐㄧ"    . ["j"   "i"   ""    ])
    ("ㄐㄧㄚ"   . ["ji"  "a"   ""    ])
    ("ㄐㄧㄝ"   . ["ji"  "e"   ""    ])
    ("ㄐㄧㄠ"   . ["ji"  "a"   "o"   ])
    ("ㄐㄧㄡ"   . ["ji"  "u"   ""    ])
    ("ㄐㄧㄢ"   . ["ji"  "a"   "n"   ])
    ("ㄐㄧㄣ"   . ["j"   "i"   "n"   ])
    ("ㄐㄧㄤ"   . ["ji"  "a"   "ng"  ])
    ("ㄐㄧㄥ"   . ["j"   "i"   "ng"  ])
    ("ㄐㄩ"    . ["j"   "u"   ""    ])
    ("ㄐㄩㄝ"   . ["ju"  "e"   ""    ])
    ("ㄐㄩㄢ"   . ["ju"  "a"   "n"   ])
    ("ㄐㄩㄣ"   . ["j"   "u"   "n"   ])
    ("ㄐㄩㄥ"   . ["ji"  "o"   "ng"  ])

    ; q-
    ("ㄑㄧ"    . ["q"   "i"   ""    ])
    ("ㄑㄧㄚ"   . ["qi"  "a"   ""    ])
    ("ㄑㄧㄝ"   . ["qi"  "e"   ""    ])
    ("ㄑㄧㄠ"   . ["qi"  "a"   "o"   ])
    ("ㄑㄧㄡ"   . ["qi"  "u"   ""    ])
    ("ㄑㄧㄢ"   . ["qi"  "a"   "n"   ])
    ("ㄑㄧㄣ"   . ["q"   "i"   "n"   ])
    ("ㄑㄧㄤ"   . ["qi"  "a"   "ng"  ])
    ("ㄑㄧㄥ"   . ["q"   "i"   "ng"  ])
    ("ㄑㄩ"    . ["q"   "u"   ""    ])
    ("ㄑㄩㄝ"   . ["qu"  "e"   ""    ])
    ("ㄑㄩㄢ"   . ["qu"  "a"   "n"   ])
    ("ㄑㄩㄣ"   . ["q"   "u"   "n"   ])
    ("ㄑㄩㄥ"   . ["qi"  "o"   "ng"  ])

    ; x-
    ("ㄒㄧ"    . ["x"   "i"   ""    ])
    ("ㄒㄧㄚ"   . ["xi"  "a"   ""    ])
    ("ㄒㄧㄝ"   . ["xi"  "e"   ""    ])
    ("ㄒㄧㄠ"   . ["xi"  "a"   "o"   ])
    ("ㄒㄧㄡ"   . ["xi"  "u"   ""    ])
    ("ㄒㄧㄢ"   . ["xi"  "a"   "n"   ])
    ("ㄒㄧㄣ"   . ["x"   "i"   "n"   ])
    ("ㄒㄧㄤ"   . ["xi"  "a"   "ng"  ])
    ("ㄒㄧㄥ"   . ["x"   "i"   "ng"  ])
    ("ㄒㄩ"    . ["x"   "u"   ""    ])
    ("ㄒㄩㄝ"   . ["xu"  "e"   ""    ])
    ("ㄒㄩㄢ"   . ["xu"  "a"   "n"   ])
    ("ㄒㄩㄣ"   . ["x"   "u"   "n"   ])
    ("ㄒㄩㄥ"   . ["xi"  "o"   "ng"  ])

    ; zh-
    ("ㄓ"     . ["zh"  "i"   ""    ])
    ("ㄓㄚ"    . ["zh"  "a"   ""    ])
    ("ㄓㄜ"    . ["zh"  "e"   ""    ])
    ("ㄓㄞ"    . ["zh"  "a"   "i"   ])
    ("ㄓㄟ"    . ["zh"  "e"   "i"   ])
    ("ㄓㄠ"    . ["zh"  "a"   "o"   ])
    ("ㄓㄡ"    . ["zh"  "o"   "u"   ])
    ("ㄓㄢ"    . ["zh"  "a"   "n"   ])
    ("ㄓㄣ"    . ["zh"  "e"   "n"   ])
    ("ㄓㄤ"    . ["zh"  "a"   "ng"  ])
    ("ㄓㄥ"    . ["zh"  "e"   "ng"  ])
    ("ㄓㄨ"    . ["zh"  "u"   ""    ])
    ("ㄓㄨㄚ"   . ["zhu" "a"   ""    ])
    ("ㄓㄨㄛ"   . ["zhu" "o"   ""    ])
    ("ㄓㄨㄞ"   . ["zhu" "a"   "i"   ])
    ("ㄓㄨㄟ"   . ["zhu" "i"   ""    ])
    ("ㄓㄨㄢ"   . ["zhu" "a"   "n"   ])
    ("ㄓㄨㄣ"   . ["zh"  "u"   "n"   ])
    ("ㄓㄨㄤ"   . ["zhu" "a"   "ng"  ])
    ("ㄓㄨㄥ"   . ["zh"  "o"   "ng"  ])

    ; ch-
    ("ㄔ"     . ["ch"  "i"   ""    ])
    ("ㄔㄚ"    . ["ch"  "a"   ""    ])
    ("ㄔㄜ"    . ["ch"  "e"   ""    ])
    ("ㄔㄞ"    . ["ch"  "a"   "i"   ])
    ("ㄔㄠ"    . ["ch"  "a"   "o"   ])
    ("ㄔㄡ"    . ["ch"  "o"   "u"   ])
    ("ㄔㄢ"    . ["ch"  "a"   "n"   ])
    ("ㄔㄣ"    . ["ch"  "e"   "n"   ])
    ("ㄔㄤ"    . ["ch"  "a"   "ng"  ])
    ("ㄔㄥ"    . ["ch"  "e"   "ng"  ])
    ("ㄔㄨ"    . ["ch"  "u"   ""    ])
    ("ㄔㄨㄚ"   . ["chu" "a"   ""    ])
    ("ㄔㄨㄛ"   . ["chu" "o"   ""    ])
    ("ㄔㄨㄞ"   . ["chu" "a"   "i"   ])
    ("ㄔㄨㄟ"   . ["chu" "i"   ""    ])
    ("ㄔㄨㄢ"   . ["chu" "a"   "n"   ])
    ("ㄔㄨㄣ"   . ["ch"  "u"   "n"   ])
    ("ㄔㄨㄤ"   . ["chu" "a"   "ng"  ])
    ("ㄔㄨㄥ"   . ["ch"  "o"   "ng"  ])

    ; sh-
    ("ㄕ"     . ["sh"  "i"   ""    ])
    ("ㄕㄚ"    . ["sh"  "a"   ""    ])
    ("ㄕㄜ"    . ["sh"  "e"   ""    ])
    ("ㄕㄞ"    . ["sh"  "a"   "i"   ])
    ("ㄕㄟ"    . ["sh"  "e"   "i"   ])
    ("ㄕㄠ"    . ["sh"  "a"   "o"   ])
    ("ㄕㄡ"    . ["sh"  "o"   "u"   ])
    ("ㄕㄢ"    . ["sh"  "a"   "n"   ])
    ("ㄕㄣ"    . ["sh"  "e"   "n"   ])
    ("ㄕㄤ"    . ["sh"  "a"   "ng"  ])
    ("ㄕㄥ"    . ["sh"  "e"   "ng"  ])
    ("ㄕㄨ"    . ["sh"  "u"   ""    ])
    ("ㄕㄨㄚ"   . ["shu" "a"   ""    ])
    ("ㄕㄨㄛ"   . ["shu" "o"   ""    ])
    ("ㄕㄨㄞ"   . ["shu" "a"   "i"   ])
    ("ㄕㄨㄟ"   . ["shu" "i"   ""    ])
    ("ㄕㄨㄢ"   . ["shu" "a"   "n"   ])
    ("ㄕㄨㄣ"   . ["sh"  "u"   "n"   ])
    ("ㄕㄨㄤ"   . ["shu" "a"   "ng"  ])

    ; r-
    ("ㄖ"     . ["r"   "i"   ""    ])
    ("ㄖㄜ"    . ["r"   "e"   ""    ])
    ("ㄖㄠ"    . ["r"   "a"   "o"   ])
    ("ㄖㄡ"    . ["r"   "o"   "u"   ])
    ("ㄖㄢ"    . ["r"   "a"   "n"   ])
    ("ㄖㄣ"    . ["r"   "e"   "n"   ])
    ("ㄖㄤ"    . ["r"   "a"   "ng"  ])
    ("ㄖㄥ"    . ["r"   "e"   "ng"  ])
    ("ㄖㄨ"    . ["r"   "u"   ""    ])
    ("ㄖㄨㄚ"   . ["ru"  "a"   ""    ])
    ("ㄖㄨㄛ"   . ["ru"  "o"   ""    ])
    ("ㄖㄨㄟ"   . ["ru"  "i"   ""    ])
    ("ㄖㄨㄢ"   . ["ru"  "a"   "n"   ])
    ("ㄖㄨㄣ"   . ["r"   "u"   "n"   ])
    ("ㄖㄨㄥ"   . ["r"   "o"   "ng"  ])

    ; z-
    ("ㄗ"     . ["z"   "i"   ""    ])
    ("ㄗㄚ"    . ["z"   "a"   ""    ])
    ("ㄗㄜ"    . ["z"   "e"   ""    ])
    ("ㄗㄞ"    . ["z"   "a"   "i"   ])
    ("ㄗㄟ"    . ["z"   "e"   "i"   ])
    ("ㄗㄠ"    . ["z"   "a"   "o"   ])
    ("ㄗㄡ"    . ["z"   "o"   "u"   ])
    ("ㄗㄢ"    . ["z"   "a"   "n"   ])
    ("ㄗㄣ"    . ["z"   "e"   "n"   ])
    ("ㄗㄤ"    . ["z"   "a"   "ng"  ])
    ("ㄗㄥ"    . ["z"   "e"   "ng"  ])
    ("ㄗㄨ"    . ["z"   "u"   ""    ])
    ("ㄗㄨㄛ"   . ["zu"  "o"   ""    ])
    ("ㄗㄨㄟ"   . ["zu"  "i"   ""    ])
    ("ㄗㄨㄢ"   . ["zu"  "a"   "n"   ])
    ("ㄗㄨㄣ"   . ["z"   "u"   "n"   ])
    ("ㄗㄨㄥ"   . ["z"   "o"   "ng"  ])

    ; c-
    ("ㄘ"     . ["c"   "i"   ""    ])
    ("ㄘㄚ"    . ["c"   "a"   ""    ])
    ("ㄘㄜ"    . ["c"   "e"   ""    ])
    ("ㄘㄞ"    . ["c"   "a"   "i"   ])
    ("ㄘㄟ"    . ["c"   "e"   "i"   ])
    ("ㄘㄠ"    . ["c"   "a"   "o"   ])
    ("ㄘㄡ"    . ["c"   "o"   "u"   ])
    ("ㄘㄢ"    . ["c"   "a"   "n"   ])
    ("ㄘㄣ"    . ["c"   "e"   "n"   ])
    ("ㄘㄤ"    . ["c"   "a"   "ng"  ])
    ("ㄘㄥ"    . ["c"   "e"   "ng"  ])
    ("ㄘㄨ"    . ["c"   "u"   ""    ])
    ("ㄘㄨㄛ"   . ["cu"  "o"   ""    ])
    ("ㄘㄨㄟ"   . ["cu"  "i"   ""    ])
    ("ㄘㄨㄢ"   . ["cu"  "a"   "n"   ])
    ("ㄘㄨㄣ"   . ["c"   "u"   "n"   ])
    ("ㄘㄨㄥ"   . ["c"   "o"   "ng"  ])

    ; s-
    ("ㄙ"     . ["s"   "i"   ""    ])
    ("ㄙㄚ"    . ["s"   "a"   ""    ])
    ("ㄙㄜ"    . ["s"   "e"   ""    ])
    ("ㄙㄞ"    . ["s"   "a"   "i"   ])
    ("ㄙㄠ"    . ["s"   "a"   "o"   ])
    ("ㄙㄡ"    . ["s"   "o"   "u"   ])
    ("ㄙㄢ"    . ["s"   "a"   "n"   ])
    ("ㄙㄣ"    . ["s"   "e"   "n"   ])
    ("ㄙㄤ"    . ["s"   "a"   "ng"  ])
    ("ㄙㄥ"    . ["s"   "e"   "ng"  ])
    ("ㄙㄨ"    . ["s"   "u"   ""    ])
    ("ㄙㄨㄛ"   . ["su"  "o"   ""    ])
    ("ㄙㄨㄟ"   . ["su"  "i"   ""    ])
    ("ㄙㄨㄢ"   . ["su"  "a"   "n"   ])
    ("ㄙㄨㄣ"   . ["s"   "u"   "n"   ])
    ("ㄙㄨㄥ"   . ["s"   "o"   "ng"  ])

    ; ∅-
    ("ㄚ"     . [""    "a"   ""    ])
    ("ㄛ"     . [""    "o"   ""    ])
    ("ㄜ"     . [""    "e"   ""    ])
    ("ㄝ"     . [""    "ê"   ""    ])
    ("ㄞ"     . [""    "a"   "i"   ])
    ("ㄟ"     . [""    "e"   "i"   ])
    ("ㄠ"     . [""    "a"   "o"   ])
    ("ㄡ"     . [""    "o"   "u"   ])
    ("ㄢ"     . [""    "a"   "n"   ])
    ("ㄣ"     . [""    "e"   "n"   ])
    ("ㄤ"     . [""    "a"   "ng"  ])
    ("ㄥ"     . [""    "e"   "ng"  ])
    ("ㄦ"     . [""    "e"   "r"   ])
    ("ㄧ"     . ["y"   "i"   ""    ])
    ("ㄧㄚ"    . ["y"   "a"   ""    ])
    ("ㄧㄛ"    . ["y"   "o"   ""    ])
    ("ㄧㄝ"    . ["y"   "e"   ""    ])
    ("ㄧㄠ"    . ["y"   "a"   "o"   ])
    ("ㄧㄡ"    . ["y"   "o"   "u"   ])
    ("ㄧㄢ"    . ["y"   "a"   "n"   ])
    ("ㄧㄣ"    . ["y"   "i"   "n"   ])
    ("ㄧㄤ"    . ["y"   "a"   "ng"  ])
    ("ㄧㄥ"    . ["y"   "i"   "ng"  ])
    ("ㄨ"     . ["w"   "u"   ""    ])
    ("ㄨㄚ"    . ["w"   "a"   ""    ])
    ("ㄨㄛ"    . ["w"   "o"   ""    ])
    ("ㄨㄞ"    . ["w"   "a"   "i"   ])
    ("ㄨㄟ"    . ["w"   "e"   "i"   ])
    ("ㄨㄢ"    . ["w"   "a"   "n"   ])
    ("ㄨㄣ"    . ["w"   "e"   "n"   ])
    ("ㄨㄤ"    . ["w"   "a"   "ng"  ])
    ("ㄨㄥ"    . ["w"   "e"   "ng"  ])
    ("ㄩ"     . ["y"   "u"   ""    ])
    ("ㄩㄝ"    . ["yu"  "e"   ""    ])
    ("ㄩㄢ"    . ["yu"  "a"   "n"   ])
    ("ㄩㄣ"    . ["y"   "u"   "n"   ])
    ("ㄩㄥ"    . ["y"   "o"   "ng"  ])))

(define zhupin-pst
  (let ([comparator
         (λ (a b)
           (cond
             [(and (char=? #\v a) (char=? #\ü b)) 'eq]
             [(char=? a b) 'eq]
             [(char<? a b) 'lt]
             [(char>? a b) 'gt]))])
    (sequence->pst
     comparator
     (for/stream ([row zhupin-table])
       (let ([key-list (string->list (string-append* (cdr row)))])
         (cons key-list row))))))
